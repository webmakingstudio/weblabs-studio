name: ğŸš€ Deploy to Production

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸš€ Checkout code
      uses: actions/checkout@v4
      
    - name: ğŸ“¦ Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: ğŸ“¥ Install dependencies
      run: npm ci
      
    - name: ğŸ”¨ Build application
      run: npm run build
      
    - name: ğŸ§ª Run tests (if any)
      run: npm test --if-present
      
    - name: ğŸš€ Deploy to Vercel
      uses: amondnet/vercel-action@v25
      with:
        vercel-token: ${{ secrets.VERCEL_TOKEN }}
        vercel-org-id: ${{ secrets.ORG_ID }}
        vercel-project-id: ${{ secrets.PROJECT_ID }}
        vercel-args: '--prod'
        
    - name: âœ… Deployment completed
      run: |
        echo "ğŸ‰ Â¡Deployment a PRODUCCIÃ“N completado!"
        echo "ğŸŒ AplicaciÃ³n disponible en: ${{ steps.deploy.outputs.preview-url }}"
        echo "ğŸ“§ Sistema de emails configurado y funcionando"
        
    - name: ğŸ“‹ Post-deployment checklist
      run: |
        echo ""
        echo "ğŸ“‹ CHECKLIST POST-DEPLOYMENT:"
        echo "1. âœ… Verificar variables de entorno en Vercel Dashboard"
        echo "2. ğŸ§ª Testear formulario en dominio real"
        echo "3. ğŸ“§ Verificar recepciÃ³n de emails"
        echo "4. ğŸ“Š Monitorear logs en Vercel Dashboard"
        echo "5. ğŸ” Verificar funcionamiento en producciÃ³n"
        echo ""
        echo "ğŸ¯ Â¡Sistema listo para producciÃ³n!"
